{% extends '::layout.html.twig' %}


{% block title %} Articles - La deMOIs’aile {% endblock %}
{% block metaDescription %}La deMOIs’aile - Liste des articles{% endblock %}
{% block content %}

   <div class="container">
      <div class="row mb-2">
          
          <div class="wrap-articles">
    
                <div class="container">
                
                    <div class="row titre">
                            
                        <div class="col-sm-12 text-center">
                            <img alt="Les derniers articles De nos blogueuses" src="{{ asset('assets/scss/images/fleur-derniers-articles-droite-la-demoisaile.png') }}" class="fleur-art">
                            <h1 class="art_h1"><span>Les derniers articles</span></h1>
                            <h4>De nos blogueuses</h4>
                        </div>

                    </div>

                </div>  
                
                <div class="container">
                      
                        {{ form_start(form) }}
                        <div class="row">
                          <div class="col-md-4">
                            <div class="form-group">
                              {{ form_label(form.ecole, "Ecole") }}
                              {{ form_widget(form.ecole, {'attr': {'class': 'form-control form_ecole'}}) }}                                    
                            </div>
                          </div>  
                          <div class="col-md-4">
                            <div class="form-group">                              
                              {{ form_label(form.date, "Date") }}
                              {{ form_widget(form.date, {'attr': {'class': 'form-control'}}) }}                                    
                            </div>
                                        
                          </div>
                          <div class="col-md-4">
                            <div class="form-group">
                              {{ form_label(form.blogueuse, "Blogueuse") }}
                              {{ form_widget(form.blogueuse, {'attr': {'class': 'form-control form_ecole form_hide_b'}}) }}

                              <input type="text" id="blocComplete" class="form-control" list="list_blogs" value="{{ blogueuse }}"/><!--your input textbox-->
                                <datalist id="list_blogs">
                                {% for bl in blogueuses %}
                                  <option data-id="{{ bl.id }}" value="{{ bl.prenom }} {{ bl.nom }}" />
                                {% endfor %}                                
                                </datalist>                                    
                            </div>
                          </div>
                          <div class="col-md-4">
                            <div class="form-group">                    
                              <br/>
                              {{ form_widget(form.send, {'attr': {'class': 'btn-secondary btn', 'style': 'vertical-align:-15px'}}) }}
                            </div>
                                        
                          </div>
                        </div> 
                        {{ form_end(form) }} 
                        <br/><br/>
                    <div class="row">
                        {% set month = "now"|date("m") %}
                        {% set year = "now"|date("Y") %}
                        {% if(month < 9) %}
                          {% set actual = (year-1)~"-"~year %}
                        {% else %}
                          {% set actual = year~"-"~(year+1) %}
                        {% endif %}
                        
                       {% for article in articles %}
                        
                          {% set month_art = article.datePublication|date("m") %}
                          {% set year_art = article.datePublication|date("Y") %}  
                          {% if(month_art < 9) %}
                              {% set actual_art = (year_art-1)~"-"~year_art %}
                          {% else %}
                              {% set actual_art = year_art~"-"~(year_art+1) %}
                          {% endif %}
                          
                          {% if actual_art != actual %}
                              <div class="col-md-12"><h4>{{ actual_art }}</h4></div>
                              {% set actual = actual_art %}
                          {% endif %}
                                    
                            {{ include('@ViwebArticle/Article/appercu.html.twig') }}
                                                        
                       {% endfor %}

                    </div>
                </div>
                

            </div>
          
          

      </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
  
  <script>
    jQuery( document ).ready(function($) {
      $(".form_ecole option:first").html('Toutes');

      $( "#blocComplete" ).on("input", function() {
        var val = $(this).val();
        //console.log(val);

        $('#list_blogs option').each(function(){
          if($(this).val() == val) {
            data_id = $(this).attr('data-id');
            $(".form_hide_b").val(data_id).change();
          }
        });  

      });
    });
  </script>
     
{% endblock %}
